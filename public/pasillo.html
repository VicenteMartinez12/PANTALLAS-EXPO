<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pasillo Turnero</title>
    <style>
        .tabla {
            border-collapse: collapse;
            width: 100%;
            margin-top: 2%;
        }

       

     
        .tabla td {
           
            padding: 8px;
            border: 1px solid black;
            font-size: 80px;
            font-weight: bold;
            align-items: center;
            text-align: center;
           
           
            
        }
        .tabla th{
            padding: 8px;
            border: 1px solid black;
            font-size: 80px;
            font-weight: bold;
        }

        .tabla tr {
            height: 100px;
        
        }

        .tabla img {
            max-width: 300px;
      
            max-height: 100px;
  
        }

        .tabla td:last-child {
            text-align: left;
          
            font-size: 130px;
            margin-right: 10%;
          
        }

        .numeros {
      display: flex;
            justify-content: space-between;

            padding: 0 10px;
            font-size: 50px;
  
            width: 98.8%;
            

            
            
          
            
        }

        @keyframes blink {
            0% {
                background-color: yellow;
            }

            50% {
                background-color: transparent;
            }

            100% {
                background-color: yellow;
            }
        }

        .parpadeo {
            animation: blink 1s infinite;
        }
     
        .image-container {
            text-align: right;
        }
   
        
    </style>
</head>

<body>
    <div style="display: flex; align-items: center;">
        <div style="max-width: 100%; width: 100%; height: 100%;">
            <div style="height: 100%; display: flex; flex-direction: column;">
                <div style=" justify-content: center; align-items: center; height: 100%; margin-top: 0%;">
                    <table style="width: 100%; height: 88%; font-size: 50px;" class="tabla">
                        <thead>
                            <tr>
                                <th style="font-size: 100px; background-color: #012475; color: antiquewhite; text-align: center; "><img src="/img/marcas/expoTony.png" alt=""></th>
                                <th style="font-size: 100px;  background-color: #012475; color: antiquewhite;    text-align: center; ">Próximos turnos   <img style="float: right;" src="/img/expoTony.png" alt=""></th>
                            </tr>
                        </thead>
                        <tbody id="tablaBody">
                            <tr id="fila-1">
                                <td  style="background-color: rgb(198, 232, 251);"><img src="" alt="" id="imagen-1"></td>
                                <td  class= "numeros"  style="background-color: rgb(198, 232, 251);">
                                    <div >  </div>
                                    <div > </div>
                                    <div > </div>
                                    <div> </div>
                                    <div> </div>
                                    
                                </td>
                            </tr>
                            <tr id="fila-2">
                                <td><img src="" alt="" id="imagen-2"></td>
                                <td style="align-content: center;" class="numeros">
                                    <div > </div>
                                    <div > </div>
                                    <div> </div>
                                    <div> </div>
                                    <div> </div>
                                   
                                    
                                </td>
                            </tr>
                            <tr id="fila-3">
                                <td  style="background-color: rgb(198, 232, 251);"><img src="" alt="" id="imagen-3"></td>
                                <td class="numeros"  style="background-color: rgb(198, 232, 251);">
                                    <div> </div>
                                    <div> </div>
                                    <div> </div>
                                    <div> </div>
                                    <div> </div>
                                </td>
                            </tr>
                            <tr id="fila-4">
                                <td><img src="" alt="" id="imagen-4"></td>
                                <td class="numeros">
                                    <div > </div>
                                    <div > </div>
                                    <div> </div>
                                    <div> </div>
                                    <div> </div>
                                </td>
                            </tr>
                            <tr id="fila-5">
                                <td  style="background-color: rgb(198, 232, 251);"><img src="" alt="" id="imagen-5"></td>
                                <td class="numeros"  style="background-color: rgb(198, 232, 251);">
                                    <div > </div>
                                    <div> </div>
                                    <div> </div>
                                    <div> </div>
                                    <div> </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script src="./socket.io/socket.io.js"></script>
    <script>
      
        const socket2 = io('http://10.105.17.44:8000');


        socket2.on('connect', () => {
            console.log('Conectado al servidor emisor');
          });


          socket2.on('recibir-turnos-pasillo', (payload) => {
            const lastIndex = payload.length - 1; // Índice del último elemento en el arreglo
            console.log(payload.slice(Math.max(lastIndex - 4, 0))); // Mostrar los últimos 5 elementos del arreglo
            payload.slice(Math.max(lastIndex - 4, 0)).forEach((data, index) => {
                const fila = document.getElementById(`fila-${index + 1}`);
                if (fila) {
                    const celdaNumeros = fila.querySelector('td.numeros');
                    if (celdaNumeros) {
                        const divsNumeros = celdaNumeros.querySelectorAll('div');
                        data.forEach((item, i) => {
                            if (divsNumeros[i]) {
                                divsNumeros[i].textContent = item.folioTurno || '';
                            }
                        });

                        // Llenar con espacios vacíos si no hay suficientes turnos
                        for (let i = data.length; i < divsNumeros.length; i++) {
                            divsNumeros[i].textContent = '\u00A0'; // Espacio en blanco
                        }
                    }
                }
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            fetch('http://10.105.17.44:8000/stands/getallstands')
                .then(response => response.json())
                .then(data => {
                    data.stands.forEach((stand, index) => {
                        const fila = document.getElementById(`fila-${index + 1}`);
                        if (fila) {
                            const celdaImagen = fila.querySelector('td:first-child img');
                            if (celdaImagen) {
                                const imageURL = `http://10.105.17.44:8000/imagenes/${stand.image}`;
                                celdaImagen.src = imageURL;
                                celdaImagen.alt = '';
                            }
                        }
                    });
                })
                .catch(error => {
                    console.error('Error al obtener los stands:', error);
                });
        });
    </script>
</body>

</html>
